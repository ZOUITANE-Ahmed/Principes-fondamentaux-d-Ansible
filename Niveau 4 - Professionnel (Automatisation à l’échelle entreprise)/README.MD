# **ğŸ“Œ Niveau 4 : Professionnel - Automatisation Ã  lâ€™Ã©chelle entreprise**  

## **ğŸ”¹ 1. DÃ©ploiement dâ€™Ansible Ã  grande Ã©chelle**  
ğŸ¯ **Objectif** : GÃ©rer une infrastructure **multi-serveurs** et centraliser lâ€™exÃ©cution des tÃ¢ches Ansible.  

### **1.1 - Gestion centralisÃ©e avec Ansible Tower (AWX)**  
âœ… **Installation dâ€™AWX sur RHEL**  
```bash
# Installer Docker et dÃ©pendances
dnf install -y podman python3-pip git

# Cloner AWX Operator
git clone https://github.com/ansible/awx-operator.git
cd awx-operator

# DÃ©ployer AWX Operator
ansible-playbook -i inventory deploy_awx.yml
```
ğŸ“Œ **AWX** permet dâ€™exÃ©cuter des **playbooks Ansible** via une **interface web** et dâ€™**automatiser les tÃ¢ches rÃ©currentes**.  

---

### **1.2 - IntÃ©gration avec CI/CD (Jenkins, GitOps)**  
ğŸ¯ **DÃ©ploiement automatique dâ€™applications aprÃ¨s chaque commit**  

âœ… **Pipeline Jenkinsfile** pour exÃ©cuter Ansible  
```groovy
pipeline {
    agent any
    stages {
        stage('Checkout') {
            steps {
                git 'https://github.com/monrepo.git'
            }
        }
        stage('Deploy') {
            steps {
                sh 'ansible-playbook -i inventory deploy_app.yml'
            }
        }
    }
}
```
ğŸš€ **RÃ©sultat** : Chaque commit **dÃ©ploie automatiquement** une mise Ã  jour via **Jenkins et Ansible**.  

---

### **1.3 - Automatisation via API REST et Webhooks**  
ğŸ¯ **ExÃ©cuter Ansible depuis une API externe**  

âœ… **Utiliser lâ€™API AWX pour lancer un job Ansible**  
```bash
curl -X POST "http://awx.local/api/v2/job_templates/5/launch/" \
     -H "Authorization: Bearer TOKEN"
```
ğŸ“Œ **Cas dâ€™usage** : Automatiser **les dÃ©ploiements**, **les mises Ã  jour**, ou **la crÃ©ation dâ€™infrastructure**.  

---

### **1.4 - Utilisation des collections Ansible**  
ğŸ¯ **Ã‰tendre les fonctionnalitÃ©s avec des collections spÃ©cifiques**  

âœ… **Installer une collection pour gÃ©rer AWS**  
```bash
ansible-galaxy collection install amazon.aws
```
âœ… **Exemple : CrÃ©er une VM sur AWS avec Ansible**  
```yaml
- name: CrÃ©er une instance EC2
  hosts: localhost
  tasks:
    - amazon.aws.ec2_instance:
        name: "serveur-test"
        key_name: "ma_cle"
        region: "eu-west-1"
        instance_type: "t2.micro"
        image_id: "ami-12345678"
```
ğŸ“Œ **Cas dâ€™usage** : DÃ©ploiement **Cloud** et **multi-cloud** avec Ansible.  

---

## **ğŸ”¹ 2. SÃ©curitÃ© et conformitÃ©**  
ğŸ¯ **Automatiser la sÃ©curisation des serveurs**  

### **2.1 - Ansible Hardening**  
âœ… **Appliquer les recommandations CIS (Center for Internet Security)**  
```yaml
- name: SÃ©curisation du systÃ¨me
  hosts: all
  become: true
  tasks:
    - name: DÃ©sactiver le root login SSH
      lineinfile:
        path: /etc/ssh/sshd_config
        regexp: '^PermitRootLogin'
        line: 'PermitRootLogin no'
      notify: Restart SSH

    - name: VÃ©rifier lâ€™Ã©tat du firewall
      service:
        name: firewalld
        state: started
        enabled: true
```
ğŸ“Œ **Cas dâ€™usage** : SÃ©curiser les **serveurs Linux** automatiquement.  

---

### **2.2 - Automatisation des rÃ¨gles SELinux et Firewalld**  
âœ… **Configurer SELinux en mode enforcing**  
```yaml
- name: Activer SELinux
  hosts: all
  become: true
  tasks:
    - name: Modifier la configuration SELinux
      selinux:
        policy: targeted
        state: enforcing
```
âœ… **GÃ©rer Firewalld avec Ansible**  
```yaml
- name: Ouvrir le port 443
  hosts: all
  become: true
  tasks:
    - firewalld:
        port: 443/tcp
        permanent: true
        state: enabled
```
ğŸ“Œ **Cas dâ€™usage** : **Appliquer des rÃ¨gles de sÃ©curitÃ©** Ã  **grande Ã©chelle**.  

---

### **2.3 - Audit et conformitÃ© des systÃ¨mes**  
ğŸ¯ **VÃ©rifier la conformitÃ© des serveurs avec un playbook Ansible**  

âœ… **ExÃ©cuter un audit automatique**  
```yaml
- name: VÃ©rification de la sÃ©curitÃ©
  hosts: all
  become: true
  tasks:
    - name: VÃ©rifier la prÃ©sence de failles CVE
      shell: "grep -i cve /var/log/syslog"
      register: cve_log

    - name: Afficher les CVE dÃ©tectÃ©es
      debug:
        msg: "{{ cve_log.stdout_lines }}"
```
ğŸš€ **RÃ©sultat** : Un **rapport des failles** et **vulnÃ©rabilitÃ©s** dÃ©tectÃ©es.  

---

# **ğŸ“Œ Objectif Final**  
âœ… GÃ©rer **des centaines de serveurs** avec **Ansible Tower/AWX**  
âœ… Automatiser avec **CI/CD et GitOps**  
âœ… Assurer la **sÃ©curitÃ© et la conformitÃ©**  
âœ… Passer au **Niveau 5 : Architecte DevOps** ğŸš€  

ğŸ’¡ **Besoin dâ€™exemples sur Kubernetes, Terraform, ou dâ€™autres intÃ©grations ?** ğŸ˜ƒ